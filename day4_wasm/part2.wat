;; MEMORY MAP
;; 0 PTR_FOR_RET_VAL ugh
;; 4 OUTPUT_STR PTR 
;; 8 OUTPUT_STR LEN 
;; 12 OUTPUT_STRING
;; 28 PUZZLE_INPUT
;; ......\0

(module
  ;; (fd, *iovs, iovs_len, nwritten) 
  ;; -> Returns number of bytes written
  (import "wasi_unstable" "fd_write" (func $fd_write (param i32 i32 i32 i32) (result i32)))

  (memory 1)
  (export "memory" (memory 0))

  ;; puzzle input
  ;;(data (i32.const 28) "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8")
  (data (i32.const 28) "24-66,23-25\n3-3,2-80\n14-80,13-20\n39-78,40-40\n36-90,89-90\n51-94,50-50\n10-72,10-98\n54-81,2-90\n27-84,27-85\n21-57,21-57\n6-55,4-5\n80-87,87-90\n23-71,22-90\n24-37,2-36\n79-91,78-91\n75-92,91-93\n23-80,23-81\n67-94,68-94\n79-85,79-81\n40-88,39-89\n15-75,14-76\n18-77,34-78\n2-99,4-93\n1-74,15-75\n39-82,39-81\n19-91,18-84\n56-87,57-86\n15-72,14-71\n37-88,36-87\n21-24,18-23\n34-83,34-34\n20-95,94-95\n27-75,26-80\n91-93,27-92\n55-66,56-62\n29-31,30-89\n85-95,89-99\n1-2,1-3\n63-64,13-64\n66-95,30-86\n2-73,3-74\n25-99,6-25\n10-28,28-87\n10-42,9-43\n12-46,46-75\n91-97,91-96\n46-59,46-59\n34-35,5-34\n27-93,93-93\n4-12,21-97\n7-65,5-8\n42-63,2-62\n70-76,64-75\n1-95,1-94\n12-30,13-30\n3-99,2-99\n46-60,58-60\n1-94,93-98\n7-98,8-98\n7-51,8-81\n39-84,40-85\n43-84,8-84\n10-93,11-93\n3-63,2-47\n18-87,18-18\n77-96,95-97\n2-99,1-99\n3-45,2-45\n19-99,8-97\n7-98,8-60\n3-94,2-2\n51-71,21-51\n28-98,10-27\n13-96,13-97\n4-99,1-1\n3-93,93-97\n13-13,14-98\n16-38,17-17\n16-46,16-46\n7-63,4-8\n18-85,13-19\n17-21,18-21\n7-74,8-73\n5-77,4-6\n11-18,1-18\n3-25,4-4\n2-96,2-93\n19-38,18-39\n11-45,10-10\n20-20,21-83\n2-97,97-97\n81-81,2-80\n5-82,58-59\n47-51,4-47\n89-93,40-89\n19-29,18-84\n18-36,16-18\n41-55,47-47\n6-34,7-33\n5-82,6-81\n6-19,18-27\n42-55,43-55\n1-99,2-71\n45-94,45-45\n2-88,1-88\n15-35,14-36\n17-36,10-25\n20-96,84-98\n81-87,81-81\n85-87,85-86\n34-74,73-74\n17-97,16-98\n11-50,12-51\n2-99,3-3\n79-90,79-91\n89-99,1-89\n87-93,72-93\n31-52,30-96\n75-84,45-83\n81-96,81-96\n84-85,24-85\n36-60,35-36\n11-91,10-91\n18-19,19-62\n50-52,50-54\n59-86,52-86\n61-65,70-70\n28-96,58-99\n10-46,46-46\n10-10,10-25\n17-72,18-18\n58-77,34-59\n3-5,5-34\n14-14,14-83\n5-88,6-14\n2-70,3-69\n42-79,48-80\n26-48,26-27\n15-84,14-85\n82-83,33-76\n14-34,5-33\n27-76,26-26\n3-88,2-2\n19-58,20-57\n26-79,25-89\n94-95,13-94\n35-77,35-78\n63-99,69-99\n18-26,27-99\n1-76,76-77\n37-44,22-44\n3-64,3-89\n54-86,55-85\n92-92,92-95\n26-38,26-38\n62-81,19-80\n20-63,8-65\n46-79,46-80\n35-71,70-72\n12-81,11-11\n34-69,18-77\n1-84,2-2\n19-24,18-21\n8-90,89-91\n12-64,64-65\n18-97,17-19\n93-93,5-93\n34-46,34-46\n14-82,13-81\n32-46,46-47\n1-8,9-97\n3-4,3-54\n85-87,69-86\n12-90,12-91\n7-11,10-33\n19-34,18-24\n36-63,26-62\n4-98,6-98\n80-96,80-81\n10-11,10-34\n21-69,8-70\n6-80,5-81\n14-92,3-15\n23-40,16-39\n8-66,20-66\n12-79,12-13\n14-61,15-52\n10-29,10-29\n36-37,36-89\n46-48,18-47\n24-98,23-25\n81-96,13-81\n6-88,1-89\n58-76,57-75\n56-76,57-75\n1-84,1-1\n1-20,2-20\n38-98,38-99\n33-73,32-73\n41-95,40-94\n29-44,28-44\n68-86,67-69\n1-66,1-2\n12-28,13-90\n28-74,19-29\n48-51,51-65\n11-64,11-64\n74-74,66-74\n2-5,5-87\n69-69,4-69\n21-51,51-56\n51-83,13-83\n12-99,5-6\n3-91,4-90\n3-55,8-36\n12-44,36-45\n6-86,5-87\n9-18,8-16\n13-63,14-57\n3-96,4-95\n41-87,42-86\n44-62,22-48\n17-62,46-63\n62-63,63-64\n31-59,30-60\n10-78,9-79\n41-97,20-96\n18-92,18-92\n30-30,30-90\n6-80,4-79\n46-98,13-36\n7-70,7-7\n35-46,25-46\n77-77,76-76\n8-10,9-78\n4-98,5-36\n37-96,41-96\n35-68,34-88\n22-69,40-70\n13-90,12-89\n11-39,12-56\n51-82,50-81\n47-96,46-73\n95-96,2-91\n66-95,56-77\n84-84,83-85\n7-58,8-87\n6-83,5-83\n23-49,14-48\n4-97,5-96\n17-18,17-46\n15-76,93-99\n63-64,63-67\n45-46,29-45\n29-84,13-84\n95-95,95-98\n19-91,11-37\n14-19,19-94\n24-93,75-91\n52-79,78-80\n3-94,4-93\n2-99,2-3\n40-96,38-95\n23-91,23-91\n88-89,66-88\n14-92,91-92\n14-94,6-94\n21-57,36-84\n15-97,99-99\n2-98,1-99\n38-80,38-80\n12-93,29-98\n19-34,20-42\n11-70,10-71\n44-95,45-95\n53-69,54-68\n33-68,10-34\n33-35,33-34\n3-5,4-66\n57-82,56-56\n36-54,36-53\n14-15,10-15\n24-51,38-52\n16-76,72-76\n56-57,3-57\n6-89,5-90\n12-45,13-70\n36-38,37-88\n19-31,25-31\n2-2,8-96\n5-92,4-69\n9-98,8-8\n5-14,5-14\n46-99,9-46\n55-56,2-55\n7-95,7-94\n45-65,41-65\n80-81,4-80\n6-47,48-86\n25-34,35-75\n72-74,71-71\n2-94,1-3\n31-49,32-49\n20-61,19-35\n11-86,11-90\n52-78,52-53\n42-42,18-43\n2-2,4-94\n8-78,78-78\n3-49,2-50\n5-74,11-73\n17-56,16-72\n46-87,47-79\n72-80,47-51\n11-69,12-12\n2-99,3-99\n13-27,12-15\n23-95,22-96\n39-41,40-96\n74-98,73-73\n82-83,80-82\n12-79,11-32\n6-58,7-7\n3-3,3-97\n4-97,24-95\n3-80,4-75\n72-83,71-84\n20-82,21-21\n6-73,6-72\n77-77,77-97\n18-57,57-57\n53-76,46-75\n21-40,20-74\n60-65,55-64\n78-78,32-78\n22-46,42-46\n4-46,3-47\n35-39,39-40\n79-90,80-89\n36-36,37-60\n9-28,13-29\n15-85,82-85\n5-5,4-79\n17-86,9-17\n6-57,57-57\n76-88,76-88\n73-79,78-80\n52-54,2-53\n1-95,6-94\n46-91,23-99\n70-86,11-71\n19-96,18-96\n25-42,24-24\n32-88,88-94\n7-93,8-99\n5-21,5-20\n34-94,93-94\n92-93,15-92\n38-84,39-85\n79-80,7-79\n48-72,72-72\n10-92,93-98\n14-53,15-92\n7-42,7-37\n11-88,11-87\n41-65,64-65\n71-85,11-64\n21-79,79-87\n80-81,22-81\n40-79,39-41\n18-67,67-91\n11-13,12-61\n1-97,96-98\n5-66,4-4\n1-1,2-75\n15-62,16-62\n28-56,28-28\n3-3,4-79\n68-94,3-68\n8-92,7-9\n69-83,69-84\n6-90,22-90\n10-20,5-10\n21-80,20-21\n15-76,14-76\n75-75,74-83\n5-13,6-22\n39-84,83-84\n30-43,34-38\n42-98,43-97\n6-29,5-59\n62-80,63-88\n5-93,6-6\n53-64,54-64\n47-47,4-47\n62-62,59-62\n46-87,46-87\n93-95,43-55\n4-4,4-19\n86-91,48-86\n22-45,23-44\n13-38,38-93\n5-36,4-20\n27-27,27-33\n10-12,11-83\n10-93,3-93\n79-80,35-80\n64-90,53-68\n52-91,47-89\n2-66,2-3\n58-58,22-57\n7-58,5-94\n3-11,4-10\n32-38,31-39\n10-76,21-29\n15-42,15-42\n9-43,9-95\n3-56,4-57\n35-68,36-68\n55-89,56-88\n2-3,2-99\n2-97,97-99\n29-66,30-65\n5-25,4-25\n52-87,51-54\n28-64,36-66\n52-90,51-51\n95-96,33-95\n1-2,1-82\n19-32,20-31\n73-75,74-83\n73-87,87-88\n19-70,70-70\n4-93,5-13\n96-96,6-95\n10-17,10-18\n70-73,24-70\n25-25,26-76\n58-58,10-58\n5-83,4-84\n45-47,46-74\n50-67,66-68\n88-89,89-93\n15-19,16-24\n28-30,2-29\n17-19,18-77\n21-94,21-83\n23-81,81-82\n2-91,3-66\n75-94,76-94\n2-4,3-99\n19-82,82-83\n3-85,3-3\n62-74,45-61\n33-33,33-47\n66-72,66-72\n62-97,61-61\n41-74,40-75\n7-89,4-7\n56-67,55-57\n6-25,25-89\n11-11,10-14\n89-98,16-97\n18-76,18-76\n23-96,61-97\n6-15,16-68\n3-99,2-99\n22-61,9-22\n45-86,44-44\n30-46,45-46\n55-86,1-97\n21-95,20-95\n20-47,48-82\n15-47,16-80\n39-51,39-52\n9-15,9-90\n1-86,85-86\n38-38,38-79\n41-41,18-42\n7-98,87-98\n9-87,60-88\n30-87,87-88\n10-58,1-6\n5-58,5-58\n38-76,37-76\n9-82,81-82\n2-10,5-43\n50-51,2-51\n35-93,34-93\n18-75,17-75\n14-59,14-59\n27-27,28-88\n61-62,46-61\n38-74,38-51\n49-87,50-50\n39-39,38-95\n48-98,2-97\n27-29,28-92\n23-55,22-54\n30-31,29-31\n11-59,10-58\n15-84,59-85\n22-57,24-56\n17-42,6-42\n5-93,92-94\n76-89,76-90\n1-84,84-85\n36-77,13-78\n31-78,31-57\n23-89,22-90\n36-37,36-48\n41-84,34-83\n6-36,5-6\n74-91,45-92\n62-99,62-65\n3-30,4-98\n9-83,9-83\n11-93,13-94\n7-35,6-6\n36-38,37-67\n84-93,1-92\n28-57,27-56\n94-97,95-98\n41-74,40-75\n7-91,12-88\n42-97,43-96\n7-13,14-85\n58-96,4-98\n15-95,47-95\n87-90,5-87\n35-71,36-71\n27-29,29-29\n21-28,28-46\n2-13,13-99\n38-52,39-51\n12-79,61-80\n59-81,19-59\n87-88,15-87\n10-53,8-10\n4-10,2-9\n13-93,69-94\n42-61,82-83\n9-97,10-10\n9-21,8-20\n42-89,89-90\n4-86,79-87\n11-58,11-47\n83-84,14-84\n5-75,32-75\n45-97,97-97\n39-39,38-48\n44-44,43-58\n50-69,49-68\n61-87,55-86\n4-95,94-95\n47-48,47-48\n40-67,39-39\n15-68,15-69\n4-84,4-84\n98-99,1-99\n3-8,8-98\n2-97,3-97\n20-46,46-90\n25-64,43-83\n26-47,26-47\n27-28,1-28\n50-52,51-64\n76-87,91-99\n39-60,38-40\n3-99,4-99\n67-82,10-67\n45-76,46-59\n16-79,15-78\n11-63,19-62\n9-54,10-55\n4-95,96-96\n16-87,15-88\n9-30,29-88\n68-69,10-68\n51-54,52-74\n2-4,4-59\n1-96,97-99\n17-90,54-91\n25-27,26-88\n95-97,57-95\n25-33,25-25\n33-64,33-47\n32-93,33-93\n3-37,37-38\n60-80,54-79\n38-39,21-39\n9-94,94-96\n27-80,27-81\n1-74,22-75\n11-89,11-89\n7-81,82-98\n5-56,56-75\n3-3,3-90\n18-62,18-19\n28-99,29-98\n2-2,2-75\n31-86,12-65\n71-72,20-71\n73-73,56-72\n94-98,7-88\n91-91,92-92\n3-98,4-97\n2-71,70-71\n5-63,63-63\n39-81,21-81\n44-44,44-78\n64-88,15-87\n95-95,92-96\n17-32,32-94\n11-81,12-82\n86-97,85-98\n92-99,8-98\n22-70,23-23\n11-97,10-11\n72-73,61-72\n25-58,24-98\n52-65,53-55\n66-67,1-66\n8-65,53-65\n83-98,82-89\n33-79,33-79\n65-79,65-92\n7-34,8-53\n27-43,34-73\n28-77,28-77\n59-96,27-98\n7-55,19-66\n2-78,3-79\n13-13,12-81\n2-92,91-92\n2-44,1-43\n32-33,32-99\n92-93,20-93\n97-98,8-98\n15-60,16-60\n3-98,2-99\n37-37,13-37\n9-82,82-97\n23-86,22-67\n18-35,9-27\n57-73,57-58\n36-93,36-37\n15-15,15-77\n52-82,51-73\n13-22,14-96\n9-67,8-68\n6-76,7-83\n1-4,1-4\n1-95,1-90\n25-29,29-80\n77-91,39-90\n7-97,8-96\n45-77,46-88\n20-59,59-82\n64-64,63-96\n31-83,32-32\n11-96,96-97\n59-77,59-59\n47-75,47-65\n8-95,2-8\n19-81,19-81\n35-36,36-37\n83-84,83-90\n4-97,2-49\n39-96,38-97\n64-99,6-86\n29-95,29-96\n27-84,7-27\n4-63,6-62\n60-66,61-66\n58-91,90-91\n44-65,62-69\n13-24,23-61\n45-88,88-93\n62-95,95-96\n1-86,1-85\n33-33,12-33\n36-67,37-66\n11-49,48-50\n4-76,1-4\n5-84,4-53\n22-65,22-65\n12-22,13-64\n16-16,16-33\n10-97,44-98\n47-52,48-64\n58-95,59-99\n18-71,37-72\n7-79,8-79\n2-61,3-98\n67-84,83-85\n56-86,82-85\n22-97,28-98\n42-57,41-57\n23-26,11-25\n45-82,5-81\n41-43,42-79\n3-93,93-93\n60-87,59-84\n93-99,44-93\n47-95,74-95\n51-52,40-52\n11-32,12-84\n4-89,1-4\n3-93,93-94\n97-97,17-96\n12-67,11-11\n25-80,39-60\n98-99,3-98\n61-62,60-62\n24-35,34-35\n10-86,11-87\n64-66,4-90\n1-1,2-89\n15-75,46-76\n71-72,17-72\n7-9,8-91\n18-36,18-70\n3-5,4-16\n8-88,7-88\n69-85,69-69\n17-46,18-47\n8-37,37-50\n2-38,1-39\n99-99,9-99\n30-78,31-89\n51-64,52-63\n11-99,1-99\n81-82,23-81\n54-62,53-53\n80-91,24-80\n96-98,75-97\n78-78,46-78\n7-88,7-89\n1-22,1-22\n5-39,5-38\n95-95,13-96\n19-49,17-85\n7-96,6-96\n29-93,49-75\n42-76,43-75\n62-62,61-70\n36-42,37-46\n5-84,91-92\n26-95,25-27\n36-81,63-82\n17-51,18-50\n34-74,34-75\n6-53,53-86\n28-28,28-36\n6-6,6-77\n42-70,41-70\n29-92,92-93\n10-50,9-51\n90-93,80-90\n3-84,28-97\n3-3,2-74\n9-92,8-10\n58-70,58-70\n1-61,2-16\n29-85,29-69\n61-96,31-96\n30-81,12-30\n25-72,24-26\n60-96,60-96\n2-29,2-28\n27-57,26-57\n5-94,2-99\n5-15,4-19\n2-46,3-29\n39-60,38-99\n1-2,1-83\n17-86,18-87\n68-95,69-94\n31-52,8-53\n80-89,81-88\n17-57,16-56\n7-28,6-24\n35-63,63-63\n42-89,88-89\n97-98,71-98\n79-82,6-68\n8-34,34-34\n66-71,38-70\n15-65,66-71\n22-82,21-83\n9-81,10-22\n19-85,18-86\n19-19,20-70\n6-76,45-76\n1-37,36-55\n49-98,98-98\n9-88,4-10\n74-83,17-82\n30-63,22-62\n8-89,4-8\n3-87,2-16\n91-91,49-91\n2-53,53-97\n9-14,13-71\n33-98,34-99\n31-58,27-59\n22-34,34-34\n3-5,4-97\n36-93,25-31\n50-62,35-61\n43-84,43-83\n60-81,19-60\n2-90,2-89\n1-3,5-44\n5-99,8-96\n7-7,8-8\n27-39,28-80\n6-89,4-5\n44-66,11-67\n15-88,7-99\n5-44,5-6\n70-95,71-94\n2-2,2-81\n99-99,4-99\n98-99,22-98\n69-78,65-77\n46-51,45-51\n34-67,66-68\n36-74,35-75\n38-63,39-62\n22-72,39-73\n15-52,16-52\n19-98,19-97\n4-99,3-3\n2-2,3-96\n3-85,4-4\n19-91,10-20\n4-20,20-78\n2-56,6-85\n6-54,5-54\n4-65,5-65\n13-74,15-74\n78-92,79-94\n68-77,62-76\n5-75,5-75\n68-85,69-88\n62-94,21-94\n6-94,5-95\n1-3,3-61\n37-68,37-69\n4-4,5-65\n96-97,3-97\n8-96,7-7\n69-96,8-91\n87-88,8-88\n17-32,74-91\n13-93,13-93\n44-46,21-45\n37-49,49-50\n9-53,53-90\n43-51,49-49\n5-91,6-92\n12-77,12-13\n29-94,30-32\n77-78,53-77\n10-62,26-83\n44-46,45-60\n79-90,79-97\n5-89,89-89\n3-64,2-65\n58-96,73-96\n49-97,16-96\n27-49,26-50\n25-51,51-71\n45-48,46-51\n80-81,3-80\n26-30,25-25\n94-95,50-94\n65-95,63-94\n11-95,3-44\n11-97,10-10\n97-98,2-97\n46-50,53-66\n7-23,22-97\n55-85,55-85\n85-92,11-85\n98-99,5-99\n60-61,4-61\n30-31,8-30\n53-54,38-53\n2-3,4-5\n3-99,2-99\n19-85,21-66\n36-53,36-50\n70-71,24-70\n19-85,20-85\n1-84,15-86\n30-57,30-58\n78-81,77-82\n19-26,26-27\n52-73,51-72\n73-89,69-88\n2-5,4-79\n9-35,10-34\n4-60,3-61\n5-5,4-69\n98-99,16-98\n57-85,85-86\n1-81,2-80\n44-73,44-73\n90-97,68-90\n75-88,1-75\n95-98,12-95\n40-66,39-67\n3-99,4-26\n52-76,93-99\n16-30,30-66\n68-69,68-69\n19-68,9-19\n37-90,37-41\n1-94,94-94\n2-2,1-83\n12-93,2-12\n27-96,17-28\n44-46,36-67\n72-90,73-89\n20-29,21-21\n7-59,59-60\n69-74,66-74\n27-82,69-83\n12-78,12-78\n13-64,63-70\n41-60,40-40\n32-96,59-97\n1-98,1-97\n9-64,8-19\n4-4,3-97\n8-96,8-9\n5-5,4-68\n44-68,45-45\n42-67,41-71\n49-50,18-49\n1-95,83-91\n7-8,7-82\n31-76,32-75\n45-63,54-64\n92-93,84-92\n94-96,95-97\n21-61,20-62\n13-67,5-42\n15-58,16-84\n47-55,29-46\n56-65,55-57\n11-53,12-52\n1-48,48-57\n20-75,15-75\n1-95,21-95\n2-39,3-90\n4-54,24-55\n8-42,41-46\n9-97,9-98\n45-83,39-82\n23-72,22-71\n68-68,62-68\n2-96,1-1\n15-90,16-91\n25-27,26-93\n34-36,30-35\n2-65,3-64\n2-54,53-54\n39-84,38-84\n9-96,10-96\n79-80,70-76\n22-47,31-47\n13-87,12-87\n87-93,87-94\n24-44,25-94\n36-93,6-97\n8-94,28-41\n50-61,56-62\n32-74,74-75\n3-78,13-78\n99-99,23-87\n25-83,25-83\n15-15,14-20\n62-63,32-63\n36-49,35-57\n48-93,14-49\n52-71,51-53\n1-2,1-11\n22-99,98-99\n28-29,28-49\n7-8,7-81\n27-64,64-93\n13-59,14-60\n12-88,10-11\n13-79,14-50\n2-3,5-87\n18-77,18-76")
  

  (func $main (export "_start")
    (call $solve)
    (call $print_int_backwards)
  )

  (func $solve (result i64)
    (local $count i64)
    (local $str_i i32)
    (local $a_lo i64)
    (local $a_hi i64)
    (local $b_lo i64)
    (local $b_hi i64)

    (loop $line_loop
      ;; grab a_lo
      (call $consumeint (local.get $str_i))
      (local.set $str_i)
      (local.set $a_lo)

      ;; incr $str_i
      (local.set $str_i
         (i32.add (i32.const 1) (local.get $str_i)))

      ;; grab a_hi
      (call $consumeint (local.get $str_i))
      (local.set $str_i)
      (local.set $a_hi)

      ;; incr $str_i
      (local.set $str_i
         (i32.add (i32.const 1) (local.get $str_i)))

      ;; grab b_lo
      (call $consumeint (local.get $str_i))
      (local.set $str_i)
      (local.set $b_lo)

      ;; incr $str_i
      (local.set $str_i
         (i32.add (i32.const 1) (local.get $str_i)))

      ;; grab b_hi
      (call $consumeint (local.get $str_i))
      (local.set $str_i)
      (local.set $b_hi)

      ;; lo_a <= hi_b and lo_b <= hi_a
      (i32.and
        (i64.le_s (local.get $a_lo) (local.get $b_hi))
        (i64.le_s (local.get $b_lo) (local.get $a_hi)))


      (if
        (then
          (local.set $count
            (i64.add (i64.const 1) (local.get $count)))
        )
      )

      ;; if this character is a newline, add 1 and continue
      ;; the loop
      (if (i32.eq
            (call $getc (local.get $str_i))
            (i32.const 10))
        (then
          ;; incr $str_i
          (local.set $str_i
             (i32.add (i32.const 1) (local.get $str_i)))
          (br $line_loop)
        )
      )
    )

    (local.get $count)
  )

  ;; reads a number from input,
  ;; and returns the new starting_position,
  ;; essentially "consuming" the input
  (func $consumeint (param $start_pos i32) (result i64 i32)
    ;; calculate length
    (local $len i32)
    (local $this_char i32)
    (local.set $len (i32.const 0))
    (loop $len_loop
      (i32.add (local.get $start_pos) (local.get $len))
      (local.set $this_char (call $getc))

      (i32.and
        ;; '0' is 48
        (i32.ge_s (local.get $this_char) (i32.const 48))
        ;; '9' is 57
        (i32.le_s (local.get $this_char) (i32.const 57))
      )

      (if 
        (then
          (local.set $len
            (i32.add (i32.const 1) (local.get $len)))
          (br $len_loop)
        )
      )
    )

    (call $atoi
      (i32.add (i32.const 28) (local.get $start_pos))
      (local.get $len)
    )
    (i32.add (local.get $start_pos) (local.get $len))
  )

  (func $getc (param $i i32) (result i32)
    ;; beginning of string is 28
    (i32.load8_u (i32.add (i32.const 28) (local.get $i)))
  )

  (func $putc (param $c i32)
    ;; 12 is where the output goes

    ;; technically we only need to do this once, not every time
    ;; we print a char, but whatever we're debugging
    ;; Creating a new io vector within linear memory
    ;; memory offset of string
    (i32.store (i32.const 4) (i32.const 12))
    ;; length of string
    (i32.store (i32.const 8) (i32.const 1))

    (i32.store (i32.const 12) (local.get $c))

    (call $fd_write
      (i32.const 1) ;; fd 1 -- stdout
      (i32.const 4) ;; *iovs - The pointer to the iov array
      (i32.const 1) ;; iovs_len 
      (i32.const 0) ;; nwritten 
    )
    drop ;; nwritten
  )

  (func $print_int_backwards (param $num i64)
    (loop $loop
      (i64.rem_s (local.get $num) (i64.const 10))

      (i64.add (i64.const 48))
      (i32.wrap_i64)
      (call $putc)

      ;; divide input by 10
      (local.set $num (i64.div_s (local.get $num) (i64.const 10)))

      (i64.gt_s (local.get $num) (i64.const 0))
      br_if $loop
    )

    ;; print a newline
    (call $putc (i32.const 10))
  )

  ;; length is 4
  ;; offset is 3
  ;;
  ;; 1234
  (func $atoi (param $addr i32) (param $size i32) (result i64)
    ;; loop counter -- starts at 0
    (local $i i32)
    (local $acc i64)

    (loop $loop
      ;; multiply result by 10
      (i64.mul (local.get $acc) (i64.const 10))
      (local.set $acc)

      ;; push next char onto the stack
      (i32.add (local.get $addr) (local.get $i))
      (i64.load8_u)
      (i64.sub (i64.const 48))
      (i64.add (local.get $acc))
      (local.set $acc)

      ;; incr loop counter
      (local.set $i (i32.add (i32.const 1) (local.get $i)))
      (i32.lt_s (local.get $i) (local.get $size))
      br_if $loop
    )
    (local.get $acc)
  )
)
